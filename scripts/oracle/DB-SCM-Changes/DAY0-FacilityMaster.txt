Step 1 :

--If table exists it will get dropped

DROP TABLE FACILITY_NEW_MASTER_SCM_10Jun;
DROP TABLE STG_FACILITY_MASTER_SCM_10Jun;
DROP TABLE FACILITY_MASTER_SCM_10Jun;

Create table FACILITY_NEW_MASTER_SCM_10Jun as select * from CMS_FACILITY_NEW_MASTER;

Create table STG_FACILITY_MASTER_SCM_10Jun as select * from CMS_STAGE_FACILITY_NEW_MASTER;

--provide the insert script
CREATE TABLE FACILITY_MASTER_SCM_10Jun 
   (	
    NEW_FACILITY_CODE VARCHAR2(100 BYTE), 
	ENTRY_NAME VARCHAR2(100 BYTE), 
	NEW_FACILITY_NAME VARCHAR2(100 BYTE), 
	NEW_FACILITY_TYPE VARCHAR2(100 BYTE), 
	NEW_FACILITY_SYSTEM VARCHAR2(100 BYTE), 
	LINE_NUMBER VARCHAR2(100 BYTE), 
	SCM_FLAG VARCHAR2(100 BYTE)
   ) ;
  
Step 2 :- Run the insert script named 'insert_facility_master.sql'  

Step 4 :- Execute the below sripts and approve the transaction those are pending.

select cur_trx_history_id,status from transaction where reference_id in (select id from CMS_FACILITY_NEW_MASTER where 
Status = 'ACTIVE')and TRANSACTION_TYPE='FACILITY_NEW_MASTER' and status <> 'ACTIVE' ;

Step 5:- Execute the below script once there are no transactions pending for approval

UPDATE CMS_FACILITY_NEW_MASTER SET SCM_FLAG = 'Yes'
WHERE NEW_FACILITY_CODE IN  
(SELECT NEW_FACILITY_CODE FROM FACILITY_MASTER_SCM_0706 WHERE SCM_FLAG= 'Yes');

UPDATE CMS_STAGE_FACILITY_NEW_MASTER SET SCM_FLAG = 'Yes'
WHERE NEW_FACILITY_CODE IN  
(SELECT NEW_FACILITY_CODE FROM FACILITY_MASTER_SCM_0706 WHERE SCM_FLAG= 'Yes');

Commit;

UPDATE CMS_FACILITY_NEW_MASTER SET SCM_FLAG = 'No'
WHERE NEW_FACILITY_CODE IN  
(SELECT NEW_FACILITY_CODE FROM FACILITY_MASTER_SCM_0706 WHERE SCM_FLAG= 'No');

UPDATE CMS_STAGE_FACILITY_NEW_MASTER SET SCM_FLAG = 'No'
WHERE NEW_FACILITY_CODE IN  
(SELECT NEW_FACILITY_CODE FROM FACILITY_MASTER_SCM_0706 WHERE SCM_FLAG= 'No');

Commit;


