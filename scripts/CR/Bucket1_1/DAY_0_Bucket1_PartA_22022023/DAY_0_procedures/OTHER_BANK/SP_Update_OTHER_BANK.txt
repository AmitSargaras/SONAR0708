CREATE OR REPLACE PROCEDURE SP_Update_OTHER_BANK
AS
  CURSOR CR_MIG_OTHER_BANK
  IS
    SELECT 
  ID,
  CMS_LE_MAIN_PROFILE_ID,
  PARTY_ID,
  BANK_ID,
  BANK_NAME,
  BANK_CODE,
  BRANCH_NAME,
  BRANCH_CODE,
  REVISED_EMAIL_ID
    FROM TEMP_CHANGES_OTHER_BANK
    WHERE UPDATE_STATUS = 'N';
  RC_FLAG_UPDATE CR_MIG_OTHER_BANK%ROWTYPE;
  COUNT_ACTUAL NUMBER(10);
BEGIN
  OPEN CR_MIG_OTHER_BANK;
  LOOP
    FETCH CR_MIG_OTHER_BANK INTO RC_FLAG_UPDATE;
    EXIT
  WHEN CR_MIG_OTHER_BANK%NOTFOUND;
    COUNT_ACTUAL := 0;
    SELECT COUNT(1)
    INTO COUNT_ACTUAL
    FROM SCI_LE_BANKING_METHOD
    WHERE CMS_LE_BANKING_METHOD_ID       = RC_FLAG_UPDATE.ID;
	
	IF(COUNT_ACTUAL>0) THEN
	
      UPDATE SCI_LE_BANKING_METHOD
      SET REVISED_EMAIL_ID = RC_FLAG_UPDATE.REVISED_EMAIL_ID
      WHERE 
	  CMS_LE_MAIN_PROFILE_ID = RC_FLAG_UPDATE.CMS_LE_MAIN_PROFILE_ID
	  AND CMS_LE_BANK_ID             = RC_FLAG_UPDATE.BANK_ID;
	  
	  UPDATE STAGE_SCI_LE_BANKING_METHOD
      SET REVISED_EMAIL_ID = RC_FLAG_UPDATE.REVISED_EMAIL_ID
      WHERE 
	  AND CMS_LE_BANK_ID             = RC_FLAG_UPDATE.BANK_ID;
	  
	  UPDATE TEMP_CHANGES_OTHER_BANK
      SET UPDATE_STATUS = 'Y'
      WHERE ID          = RC_FLAG_UPDATE.ID;
    END IF;
  END LOOP;
  CLOSE CR_MIG_OTHER_BANK;
  COMMIT;
END;