INSERT INTO cms_function_access values ((select max(id) + 1 from CMS_FUNCTION_ACCESS ),'ExcLineForSTPSRM','*','1004');
INSERT INTO cms_function_access values ((select max(id) + 1 from CMS_FUNCTION_ACCESS ),'ExcLineForSTPSRM','*','1005');

insert into transaction_type_name (transaction_type, name, transaction_subtype,access_name)
values('EXC_LINE_FR_STP_SRM', 'Exclusion line for STP of SRM', null, 2);

insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','PENDING_CREATE', 'Pending Create',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','REJECTED', 'Rejected',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','CLOSED', 'Closed',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','PENDING_UPDATE', 'Pending Update',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','PENDING_DELETE', 'Pending Delete',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','ACTIVE', 'Approved',
'Exclusion line for STP of SRM','PENDING_UPDATE',null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','ACTIVE', 'Approved',
'Exclusion line for STP of SRM','PENDING_CREATE',null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','DRAFT', 'Draft',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','DELETED', 'Deleted',
'Exclusion line for STP of SRM',null,null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','ACTIVE', 'Closed',
'Exclusion line for STP of SRM','REJECTED',null);
insert into CMS_TRX_TOTRACK (TRANSACTION_TYPE, TOTRACK_URL, CURR_STATE, USER_STATE, USER_TRX_TYPE, FROM_STATE, TRANSACTION_SUBTYPE)
values ('EXC_LINE_FR_STP_SRM',
'ExcLineForSTPSRM.do?event=rejected_delete_read'||'&'||'toTrack=yes'||'&'||'TrxId=','ACTIVE', 'Closed',
'Exclusion line for STP of SRM','DRAFT',null);

insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CREATE', 'ND','PENDING_CREATE','PENDING_CREATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'APPROVE', 'PENDING_UPDATE','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'UPDATE', 'ACTIVE','PENDING_UPDATE','PENDING_UPDATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'EDIT_REJECTED_DELETE', 'REJECTED','PENDING_DELETE','PENDING_DELETE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CREATE', 'PENDING_CREATE','PENDING_CREATE','PENDING_CREATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'APPROVE_CREATE', 'PENDING_CREATE','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'REJECT', 'PENDING_UPDATE','REJECTED','REJECTED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'EDIT_REJECTED_UPDATE', 'REJECTED','PENDING_UPDATE','PENDING_UPDATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CLOSE_REJECTED_UPDATE', 'REJECTED','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'REJECT', 'PENDING_CREATE','REJECTED','REJECTED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CLOSE_REJECTED_CREATE', 'REJECTED','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'EDIT_REJECTED_CREATE', 'REJECTED','PENDING_CREATE','PENDING_CREATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'DELETE', 'ACTIVE','PENDING_DELETE','PENDING_DELETE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'DELETE', 'PENDING_DELETE','DELETED','DELETED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'REJECT', 'PENDING_DELETE','REJECTED','REJECTED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CLOSE_REJECTED_DELETE', 'REJECTED','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'UPDATE', 'PENDING_UPDATE','ACTIVE','PENDING_UPDATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CHECKER_APPROVE_UPDATE', 'PENDING_UPDATE','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CHECKER_APPROVE_DELETE', 'PENDING_DELETE','DELETED','DELETED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'APPROVE', 'PENDING_DELETE','DELETED','DELETED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CHECKER_APPROVE_UPDATE', 'PENDING_DELETE','DELETED','DELETED', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'MAKER_SAVE', 'PENDING_PERFECTION','DRAFT','DRAFT', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CREATE', 'DRAFT','PENDING_CREATE','PENDING_CREATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'MAKER_UPDATE_SAVE', 'ACTIVE','DRAFT','DRAFT', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'UPDATE', 'DRAFT','PENDING_UPDATE','PENDING_UPDATE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'MAKER_UPDATE_CLOSE', 'DRAFT','ACTIVE','ACTIVE', 1, 1);
insert into TR_STATE_MATRIX (STATEID, STATEINS, OPERATION, FROMSTATE, TOSTATE, USERSTATE, ENABLEIND, FRONTENDOP)
values((select max(stateid) + 1 from TR_STATE_MATRIX), 'EXC_LINE_FR_STP_SRM',
'CREATE', 'PENDING_PERFECTION','DRAFT','DRAFT', 1, 1);


insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='EDIT_REJECTED_DELETE' and FROMSTATE ='REJECTED' AND TOSTATE='PENDING_DELETE' AND USERSTATE='PENDING_DELETE')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_prepare_resubmit_delete'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='CREATE' and FROMSTATE ='PENDING_CREATE' AND TOSTATE='PENDING_CREATE' AND USERSTATE='PENDING_CREATE')
,1005,'Process','ExcLineForSTPSRM.do?event=checker_process_create'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='REJECT' and FROMSTATE ='PENDING_UPDATE' AND TOSTATE='REJECTED' AND USERSTATE='REJECTED')
,1005,'Process','ExcLineForSTPSRM.do?event=checker_process_edit'||'&'||'TrxId=',null);


insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='EDIT_REJECTED_UPDATE' and FROMSTATE ='REJECTED' AND TOSTATE='PENDING_UPDATE' AND USERSTATE='PENDING_UPDATE')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_prepare_resubmit_create'||'&'||'TrxId=',null);


insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='CLOSE_REJECTED_UPDATE' and FROMSTATE ='REJECTED' AND TOSTATE='ACTIVE' AND USERSTATE='ACTIVE')
,1004,'Close','ExcLineForSTPSRM.do?event=maker_prepare_close'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='EDIT_REJECTED_CREATE' and FROMSTATE ='REJECTED' AND TOSTATE='PENDING_CREATE' AND USERSTATE='PENDING_CREATE')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_prepare_resubmit_create'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='DELETE' and FROMSTATE ='PENDING_DELETE' AND TOSTATE='DELETED' AND USERSTATE='DELETED')
,1005,'Process','ExcLineForSTPSRM.do?event=checker_process_delete'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='UPDATE' and FROMSTATE ='PENDING_UPDATE' AND TOSTATE='ACTIVE' AND USERSTATE='PENDING_UPDATE')
,1005,'Process','ExcLineForSTPSRM.do?event=checker_process_edit'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='MAKER_SAVE' and FROMSTATE ='PENDING_PERFECTION' AND TOSTATE='DRAFT' AND USERSTATE='DRAFT')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_save_process'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='CREATE' and FROMSTATE ='DRAFT' AND TOSTATE='PENDING_CREATE' AND USERSTATE='PENDING_CREATE')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_save_process'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='UPDATE' and FROMSTATE ='DRAFT' AND TOSTATE='PENDING_UPDATE' AND USERSTATE='PENDING_UPDATE')
,1004,'Process','ExcLineForSTPSRM.do?event=maker_update_save_process'||'&'||'TrxId=',null);

insert into CMS_STATEMATRIX_ACTION (STATE_ID, TEAM_MEMBERSHIP_TYPE_ID, USER_ACTION, URL, TOTRACK_URL)
values((select stateid from TR_STATE_MATRIX where STATEINS ='EXC_LINE_FR_STP_SRM' 
and OPERATION='MAKER_UPDATE_CLOSE' and FROMSTATE ='DRAFT' AND TOSTATE='ACTIVE' AND USERSTATE='ACTIVE')
,1004,'Close','ExcLineForSTPSRM.do?event=maker_draft_close_process'||'&'||'TrxId=',null);

CREATE TABLE CMS_EXC_LINE_FR_STP_SRM
( ID NUMBER(19,0) NOT NULL, 
	LINE_CODE VARCHAR2(300 CHAR) NOT NULL, 
	EXCLUDED VARCHAR(5), 
	STATUS VARCHAR2(20 BYTE), 
	VERSION_TIME NUMBER(19,0), 
	CREATED_BY VARCHAR2(50 BYTE), 
	CREATION_DATE TIMESTAMP (9), 
  LAST_UPDATE_BY VARCHAR2(50 BYTE), 
	LAST_UPDATE_DATE TIMESTAMP (9), 
	DEPRECATED VARCHAR2(50 BYTE)
  );
  
  CREATE SEQUENCE  CMS_EXC_LINE_FR_STP_SRM_SEQ  MINVALUE 1 MAXVALUE 999999999 INCREMENT BY 1 START WITH 1 NOCACHE  NOORDER  CYCLE;
  
  CREATE TABLE STG_EXC_LINE_FR_STP_SRM
( ID NUMBER(19,0) NOT NULL, 
	LINE_CODE VARCHAR2(300 CHAR) NOT NULL, 
	EXCLUDED VARCHAR(5), 
	STATUS VARCHAR2(20 BYTE), 
	VERSION_TIME NUMBER(19,0), 
	CREATED_BY VARCHAR2(50 BYTE), 
	CREATION_DATE TIMESTAMP (9), 
  LAST_UPDATE_BY VARCHAR2(50 BYTE), 
	LAST_UPDATE_DATE TIMESTAMP (9), 
	DEPRECATED VARCHAR2(50 BYTE)
  );
  
CREATE SEQUENCE  STG_EXC_LINE_FR_STP_SRM_SEQ  MINVALUE 1 MAXVALUE 999999999 INCREMENT BY 1 START WITH 1 NOCACHE  NOORDER  CYCLE;
  
alter table CMS_INTERFACE_LOG add (CAMEXTDATE VARCHAR2(2000));

create or replace function isExcludedForSTPOfSRM(P_CMS_LSP_SYS_XREF_ID in number, P_LINE_CODE IN VARCHAR2)
  return varchar2 as
  mst_cnt number;
  sblc_cnt number;
begin
  select count(*) into mst_cnt from CMS_EXC_LINE_FR_STP_SRM t1 where t1.LINE_CODE  = P_LINE_CODE and t1.EXCLUDED = 'on' 
  and t1.STATUS = 'ACTIVE' AND t1.DEPRECATED = 'N';

  if(mst_cnt > 0) then
     return 'FALSE';
  end if;
  
  select count(*) into sblc_cnt from CMS_SECURITY where CMS_COLLATERAL_ID in (
    SELECT CMS_COLLATERAL_ID FROM CMS_LIMIT_SECURITY_MAP WHERE CMS_LSP_APPR_LMTS_ID 
    in (
    select DISTINCT t1.CMS_LSP_APPR_LMTS_ID from SCI_LSP_APPR_LMTS t1 
    inner join SCI_LSP_LMTS_XREF_MAP t2 on t2.CMS_LSP_APPR_LMTS_ID = t1.CMS_LSP_APPR_LMTS_ID
    inner join SCI_LSP_SYS_XREF t3 on t3.CMS_LSP_SYS_XREF_ID = t2.CMS_LSP_SYS_XREF_ID
    where t1.CMS_LIMIT_STATUS = 'ACTIVE' and t2.CMS_STATUS = 'ACTIVE' and t3.CMS_LSP_SYS_XREF_ID = P_CMS_LSP_SYS_XREF_ID
    )
    and update_status_ind !='D'
  )
  and SECURITY_SUB_TYPE_ID in ('GT402', 'GT403') and CMV > 0;
  
  if(sblc_cnt > 0) then
     return 'FALSE';
  end if;
  
  return 'TRUE';
end;