@echo off

call set_mig_env.cmd %*

IF NOT "%IS_PROCEED%"=="true" (
	goto end
)

rem SEC
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (1,3,4,5,6)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_CL (CIF_NUMBER,FAC_DESC,SOURCE_SECURITY_ID,SECURITY_TYPE,SECURITY_SUB_TYPE) FOR EXCEPTION "%DB_SCHEMA%".MIG_CL_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_CL IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_CL USE "%DB_SCHEMA%".MIG_CL_ERR

rem CHARGE
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (4,2)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_CHARGE_CL (SOURCE_SECURITY_ID, SOURCE_LIMIT_ID) FOR EXCEPTION "%DB_SCHEMA%".MIG_CHARGE_CL_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_CHARGE_CL IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_CHARGE_CL USE "%DB_SCHEMA%".MIG_CHARGE_CL_ERR


:end
