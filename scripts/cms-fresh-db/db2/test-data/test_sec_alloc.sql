select next value for trx_seq from sysibm.sysdummy1;

/***************************
	Create Limit
***************************/	
update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0007';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0008';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0009';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000
where lmt_id = 'ARBS-FAC-0010';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0011';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0012';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0013';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0014';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0015';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0020';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0021';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0022';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0016';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0017';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 100000 
where lmt_id = 'ARBS-FAC-0018';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0019';

update sci_lsp_appr_lmts set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 100000 
where lmt_id = 'ARBS-FAC-0003';

update sci_lsp_appr_lmts set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0004';

update sci_lsp_appr_lmts set
lmt_amt = 900000, CMS_DRAWING_LIMIT = 900000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0006';

update sci_lsp_appr_lmts set
lmt_amt = 900000, CMS_DRAWING_LIMIT = 900000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0005';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0007';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0008';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0009';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000
where lmt_id = 'ARBS-FAC-0010';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0011';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0012';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0013';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0014';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0015';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0020';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0021';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0022';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0016';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0017';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 100000 
where lmt_id = 'ARBS-FAC-0018';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0019';

update stage_limit set
lmt_amt = 500000, CMS_DRAWING_LIMIT = 500000, CMS_OUTSTANDING_AMT = 100000 
where lmt_id = 'ARBS-FAC-0003';

update stage_limit set
lmt_amt = 200000, CMS_DRAWING_LIMIT = 200000, CMS_OUTSTANDING_AMT = 200000 
where lmt_id = 'ARBS-FAC-0004';

update stage_limit set
lmt_amt = 900000, CMS_DRAWING_LIMIT = 900000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0006';

update stage_limit set
lmt_amt = 900000, CMS_DRAWING_LIMIT = 900000, CMS_OUTSTANDING_AMT = 500000 
where lmt_id = 'ARBS-FAC-0005';



/**********************************
	Create Customer Account
**********************************/
update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0003';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0004';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0005';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0006';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'Y'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0007';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0008';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0009';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0010';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0011';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0016';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0017';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'D', acct_delq_ind = 'Y'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0018';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0012';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0013';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0014';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0015';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'N'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0002';

update sci_lsp_sys_xref
set LSX_EXT_SYS_ACCT_TYPE = 'L', acct_delq_ind = 'Y'
where LSX_EXT_SYS_ACCT_NUM = 'ARBS-ACT-0001';

delete from cms_npl where account_number = 'ARBS-ACT-0004';
delete from cms_npl where account_number = 'ARBS-ACT-0010';

/***************************
	Create Limit
***************************/	
insert into sci_lsp_appr_lmts
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, source_id,
lmt_fac_type_num, lmt_fac_type_value, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select 20070101000000 + next value for limit_seq, cms_lsp_lmt_profile_id, 'ARBS-FAC-0050', '27', '60',
'25', 'OUTER', 200000, 'MYR', llp_le_id, llp_lsp_id,
'ACTIVE', cms_orig_country, cms_orig_organisation, 'ARBS',
'26', 'ARBS001', 200000, 200000
from sci_lsp_lmt_profile where llp_le_id = 'ARBS-00008';



insert into stage_limit
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT
from sci_lsp_appr_lmts
where lmt_id in ('ARBS-FAC-0050') ;

/**********************************
	Create Customer Account
**********************************/
insert into sci_lsp_sys_xref
(cms_lsp_sys_xref_id, lsx_le_id, lsx_lsp_id, LSX_EXT_SYS_CODE_NUM, LSX_EXT_SYS_CODE_VALUE,
LSX_EXT_SYS_ACCT_NUM, CMS_LE_SUB_PROFILE_ID, LSX_EXT_CTY_CODE_VALUE, acct_delq_ind, acct_status,
LSX_EXT_SYS_ACCT_TYPE)
select 20070101000000 + next value for customer_x_ref_seq, lsp_le_id, lsp_id, '37', 'ARBS',
'ARBS-ACT-0050', cms_le_sub_profile_id, cms_sub_orig_country, 'N', 'A', 'L'
from sci_le_sub_profile where lsp_le_id = 'ARBS-00008';




/*********************************
	Create Account Limit Linkage
**********************************/
insert into sci_lsp_lmts_xref_map
(cms_lsp_lmts_xref_map_id, lxm_le_id, lxm_lmt_id, lxm_lsp_id, 
cms_lsp_appr_lmts_id, cms_status, cms_lsp_sys_xref_id)
select 20070101000000 + next value for limit_x_ref_seq, lmt.lmt_le_id, lmt.lmt_id, lmt.lmt_lsp_id, 
lmt.cms_lsp_appr_lmts_id, 'ACTIVE', 
	(select xref.cms_lsp_sys_xref_id
	from sci_lsp_sys_xref xref
	where xref.lsx_ext_sys_acct_num = 'ARBS-ACT-0050')
from sci_lsp_appr_lmts lmt
where lmt_id = 'ARBS-FAC-0050';



/********************************
	Create limit transaction
********************************/	
insert into transaction 
(transaction_id, 
transaction_type, from_state, user_id, creation_date, transaction_date,
reference_id, status, staging_reference_id, team_id, version, trx_reference_id, opsdesc,
trx_origin_country, trx_origin_organisation, trx_segment, to_group_type_id,
to_group_id, to_user_id)
select CAST((TS_FMT(CURRENT_TIMESTAMP, 'yyyymmdd') || SUBSTR(DIGITS(NEXT VALUE FOR TRX_SEQ), 2)) AS CHAR(17)),
'LIMIT', 'ND', -1, current timestamp, current timestamp, 
cms_lsp_appr_lmts_id, 'ACTIVE', cms_lsp_appr_lmts_id, 0, 1, -999999999, 'SYSTEM_CREATE',
'--', '--', '--', '-999999999', -999999999, -999999999
from sci_lsp_appr_lmts where lmt_id = 'ARBS-FAC-0050';


/***************************
	Create Limit
***************************/	
insert into sci_lsp_appr_lmts
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, source_id,
lmt_fac_type_num, lmt_fac_type_value, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select 20070101000000 + next value for limit_seq, cms_lsp_lmt_profile_id, 'ARBS-FAC-0051', '27', '60',
'25', 'OUTER', 200000, 'MYR', llp_le_id, llp_lsp_id,
'ACTIVE', cms_orig_country, cms_orig_organisation, 'ARBS',
'26', 'ARBS001', 200000, 100000
from sci_lsp_lmt_profile where llp_le_id = 'ARBS-00009';


insert into stage_limit
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT
from sci_lsp_appr_lmts
where lmt_id in ('ARBS-FAC-0051') ;

/**********************************
	Create Customer Account
**********************************/
insert into sci_lsp_sys_xref
(cms_lsp_sys_xref_id, lsx_le_id, lsx_lsp_id, LSX_EXT_SYS_CODE_NUM, LSX_EXT_SYS_CODE_VALUE,
LSX_EXT_SYS_ACCT_NUM, CMS_LE_SUB_PROFILE_ID, LSX_EXT_CTY_CODE_VALUE, acct_delq_ind, acct_status,
LSX_EXT_SYS_ACCT_TYPE)
select 20070101000000 + next value for customer_x_ref_seq, lsp_le_id, lsp_id, '37', 'ARBS',
'ARBS-ACT-0051', cms_le_sub_profile_id, cms_sub_orig_country, 'N', 'A', 'D'
from sci_le_sub_profile where lsp_le_id = 'ARBS-00009';


/*********************************
	Create Account Limit Linkage
**********************************/
insert into sci_lsp_lmts_xref_map
(cms_lsp_lmts_xref_map_id, lxm_le_id, lxm_lmt_id, lxm_lsp_id, 
cms_lsp_appr_lmts_id, cms_status, cms_lsp_sys_xref_id)
select 20070101000000 + next value for limit_x_ref_seq, lmt.lmt_le_id, lmt.lmt_id, lmt.lmt_lsp_id, 
lmt.cms_lsp_appr_lmts_id, 'ACTIVE', 
	(select xref.cms_lsp_sys_xref_id
	from sci_lsp_sys_xref xref
	where xref.lsx_ext_sys_acct_num = 'ARBS-ACT-0051')
from sci_lsp_appr_lmts lmt
where lmt_id = 'ARBS-FAC-0051';

/********************************
	Create limit transaction
********************************/	
insert into transaction 
(transaction_id, 
transaction_type, from_state, user_id, creation_date, transaction_date,
reference_id, status, staging_reference_id, team_id, version, trx_reference_id, opsdesc,
trx_origin_country, trx_origin_organisation, trx_segment, to_group_type_id,
to_group_id, to_user_id)
select CAST((TS_FMT(CURRENT_TIMESTAMP, 'yyyymmdd') || SUBSTR(DIGITS(NEXT VALUE FOR TRX_SEQ), 2)) AS CHAR(17)),
'LIMIT', 'ND', -1, current timestamp, current timestamp, 
cms_lsp_appr_lmts_id, 'ACTIVE', cms_lsp_appr_lmts_id, 0, 1, -999999999, 'SYSTEM_CREATE',
'--', '--', '--', '-999999999', -999999999, -999999999
from sci_lsp_appr_lmts where lmt_id = 'ARBS-FAC-0051';


/***************************
	Create Limit
***************************/	
insert into sci_lsp_appr_lmts
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, source_id,
lmt_fac_type_num, lmt_fac_type_value, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select 20070101000000 + next value for limit_seq, cms_lsp_lmt_profile_id, 'ARBS-FAC-0054', '27', 'A5',
'25', 'OUTER', 200000, 'MYR', llp_le_id, llp_lsp_id,
'ACTIVE', cms_orig_country, cms_orig_organisation, 'ARBS',
'26', 'ARBS001', 200000, 200000
from sci_lsp_lmt_profile where llp_le_id = 'ARBS-00002';



insert into stage_limit
(cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT)
select cms_lsp_appr_lmts_id, cms_limit_profile_id, lmt_id, lmt_prd_type_num, lmt_prd_type_value,
lmt_type_num, lmt_type_value, lmt_amt, lmt_crrncy_iso_code, lmt_le_id, lmt_lsp_id, 
cms_limit_status, cms_bkg_country, cms_bkg_organisation, CMS_DRAWING_LIMIT, CMS_OUTSTANDING_AMT
from sci_lsp_appr_lmts
where lmt_id in ('ARBS-FAC-0054') ;

/**********************************
	Create Customer Account
**********************************/
insert into sci_lsp_sys_xref
(cms_lsp_sys_xref_id, lsx_le_id, lsx_lsp_id, LSX_EXT_SYS_CODE_NUM, LSX_EXT_SYS_CODE_VALUE,
LSX_EXT_SYS_ACCT_NUM, CMS_LE_SUB_PROFILE_ID, LSX_EXT_CTY_CODE_VALUE, acct_delq_ind, acct_status,
LSX_EXT_SYS_ACCT_TYPE)
select 20070101000000 + next value for customer_x_ref_seq, lsp_le_id, lsp_id, '37', 'ARBS',
'ARBS-ACT-0052', cms_le_sub_profile_id, cms_sub_orig_country, 'N', 'A', 'L'
from sci_le_sub_profile where lsp_le_id = 'ARBS-00002';

insert into sci_lsp_sys_xref
(cms_lsp_sys_xref_id, lsx_le_id, lsx_lsp_id, LSX_EXT_SYS_CODE_NUM, LSX_EXT_SYS_CODE_VALUE,
LSX_EXT_SYS_ACCT_NUM, CMS_LE_SUB_PROFILE_ID, LSX_EXT_CTY_CODE_VALUE, acct_delq_ind, acct_status,
LSX_EXT_SYS_ACCT_TYPE)
select 20070101000000 + next value for customer_x_ref_seq, lsp_le_id, lsp_id, '37', 'ARBS',
'ARBS-ACT-0053', cms_le_sub_profile_id, cms_sub_orig_country, 'N', 'A', 'L'
from sci_le_sub_profile where lsp_le_id = 'ARBS-00002';

insert into sci_lsp_sys_xref
(cms_lsp_sys_xref_id, lsx_le_id, lsx_lsp_id, LSX_EXT_SYS_CODE_NUM, LSX_EXT_SYS_CODE_VALUE,
LSX_EXT_SYS_ACCT_NUM, CMS_LE_SUB_PROFILE_ID, LSX_EXT_CTY_CODE_VALUE, acct_delq_ind, acct_status,
LSX_EXT_SYS_ACCT_TYPE)
select 20070101000000 + next value for customer_x_ref_seq, lsp_le_id, lsp_id, '37', 'ARBS',
'ARBS-ACT-0054', cms_le_sub_profile_id, cms_sub_orig_country, 'Y', 'A', 'D'
from sci_le_sub_profile where lsp_le_id = 'ARBS-00002';

/*********************************
	Create Account Limit Linkage
**********************************/
insert into sci_lsp_lmts_xref_map
(cms_lsp_lmts_xref_map_id, lxm_le_id, lxm_lmt_id, lxm_lsp_id, 
cms_lsp_appr_lmts_id, cms_status, cms_lsp_sys_xref_id)
select 20070101000000 + next value for limit_x_ref_seq, lmt.lmt_le_id, lmt.lmt_id, lmt.lmt_lsp_id, 
lmt.cms_lsp_appr_lmts_id, 'ACTIVE', 
	(select xref.cms_lsp_sys_xref_id
	from sci_lsp_sys_xref xref
	where xref.lsx_ext_sys_acct_num = 'ARBS-ACT-0052')
from sci_lsp_appr_lmts lmt
where lmt_id = 'ARBS-FAC-0003';

insert into sci_lsp_lmts_xref_map
(cms_lsp_lmts_xref_map_id, lxm_le_id, lxm_lmt_id, lxm_lsp_id, 
cms_lsp_appr_lmts_id, cms_status, cms_lsp_sys_xref_id)
select 20070101000000 + next value for limit_x_ref_seq, lmt.lmt_le_id, lmt.lmt_id, lmt.lmt_lsp_id, 
lmt.cms_lsp_appr_lmts_id, 'ACTIVE', 
	(select xref.cms_lsp_sys_xref_id
	from sci_lsp_sys_xref xref
	where xref.lsx_ext_sys_acct_num = 'ARBS-ACT-0053')
from sci_lsp_appr_lmts lmt
where lmt_id = 'ARBS-FAC-0004';

insert into sci_lsp_lmts_xref_map
(cms_lsp_lmts_xref_map_id, lxm_le_id, lxm_lmt_id, lxm_lsp_id, 
cms_lsp_appr_lmts_id, cms_status, cms_lsp_sys_xref_id)
select 20070101000000 + next value for limit_x_ref_seq, lmt.lmt_le_id, lmt.lmt_id, lmt.lmt_lsp_id, 
lmt.cms_lsp_appr_lmts_id, 'ACTIVE', 
	(select xref.cms_lsp_sys_xref_id
	from sci_lsp_sys_xref xref
	where xref.lsx_ext_sys_acct_num = 'ARBS-ACT-0054')
from sci_lsp_appr_lmts lmt
where lmt_id = 'ARBS-FAC-0054';


/************************************
Create Account NPL
*************************************/
insert into cms_npl (cms_npl_id, account_number, source_id, status, npl_date)
select 20070101000000 + next value for npl_seq, lsx_ext_sys_acct_num, lsx_ext_sys_code_value, 'Y', timestamp('2007-08-08-00.00.00')
from sci_lsp_sys_xref
where lsx_ext_sys_acct_num = 'ARBS-ACT-0054';

/********************************
	Create limit transaction
********************************/	
insert into transaction 
(transaction_id, 
transaction_type, from_state, user_id, creation_date, transaction_date,
reference_id, status, staging_reference_id, team_id, version, trx_reference_id, opsdesc,
trx_origin_country, trx_origin_organisation, trx_segment, to_group_type_id,
to_group_id, to_user_id)
select CAST((TS_FMT(CURRENT_TIMESTAMP, 'yyyymmdd') || SUBSTR(DIGITS(NEXT VALUE FOR TRX_SEQ), 2)) AS CHAR(17)),
'LIMIT', 'ND', -1, current timestamp, current timestamp, 
cms_lsp_appr_lmts_id, 'ACTIVE', cms_lsp_appr_lmts_id, 0, 1, -999999999, 'SYSTEM_CREATE',
'--', '--', '--', '-999999999', -999999999, -999999999
from sci_lsp_appr_lmts where lmt_id = 'ARBS-FAC-0054';

commit work;