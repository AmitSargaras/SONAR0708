#!/bin/bash

. ../set_mig_env.sh $*

if [ -e "$FILE_PATH.ht" ]; then
	. ../hash_total.sh check "$FILE_PATH" "$FILE_PATH.ht" 107,15 
fi

if [ ! "$IS_PROCEED" = "true" ]; then
	return
fi

"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF ASC MODIFIED BY TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L \( 1 1, 2 20, 21 63, 64 82, 83 85, 86 104, 105 106, 107 121, 122 129, 130 149, 150 157, 158 167, 168 177, 178 178, 179 179, 180 199, 200 200, 201 201\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".MIG_CO017_CD \(RECORD_TYPE, SECURITY_ID, LIMIT_ID, APPLICATION_NO, FACILITY_CODE, FACILITY_SEQ, RANKING_OF_SECURITY, CHARGE_AMT, DATE_LEGALLY_CHARGE, PRESENTATION_NO, PRESENTATION_DATE, FOLIO, JILID, FIRST_THIRD_PARTY_CHARGE, CHARGE_TYPE_CODE, NATURE_OF_CHARGE, CHARGE_PENDING_REDEMPTION, CAVEAT_WAIVED_IND \) NONRECOVERABLE INDEXING MODE AUTOSELECT