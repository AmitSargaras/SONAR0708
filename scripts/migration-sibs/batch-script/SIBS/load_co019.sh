#!/bin/bash

. ../set_mig_env.sh $*

if [ -e "$FILE_PATH.ht" ]; then
	. ../hash_total.sh check "$FILE_PATH" "$FILE_PATH.ht" 105,15 120,5 125,15 140,5
fi

if [ ! "$IS_PROCEED" = "true" ]; then
	return
fi

"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF ASC MODIFIED BY TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L \( 1 1, 2 20, 21 63, 64 82, 83 85, 86 104, 105 119, 120 124, 125 139, 140 144\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".MIG_CO019_PL \(RECORD_TYPE, SECURITY_ID, LIMIT_ID, APPLICATION_NO, FACILITY_CODE, FACILITY_SEQUENCE, AMOUNT_PLEDGED, PERCENT_PLEDGED, AMOUNT_DRAW, PERCENT_DRAW\) NONRECOVERABLE INDEXING MODE AUTOSELECT