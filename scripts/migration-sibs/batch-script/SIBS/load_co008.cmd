@echo off

call ..\set_mig_env.cmd %*

IF EXIST "%FILE_PATH%.ht" (
  call ..\hash_total.cmd check "%FILE_PATH%" "%FILE_PATH%.ht" 245,15
)

IF NOT "%IS_PROCEED%"=="true" (
	goto end
)

db2 LOAD FROM "%FILE_PATH%" OF ASC MODIFIED BY TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L ( 1 1, 2 21, 22 61, 62 101, 102 161, 162 164, 165 184, 185 204, 205 224, 225 244, 245 259, 260 299, 300 329, 330 330, 331 331, 332 339, 340 347, 348 348, 349 349, 350 369, 370 370, 371 371, 372 471, 472 479, 480 529, 530 531, 532 532, 533 582, 583 583, 584 603, 604 625, 626 633, 634 634, 635 649, 650 652, 653 667, 668 668, 669 672) MESSAGES "%LOG_PATH%" REPLACE INTO "%DB_SCHEMA%".MIG_CO008_MS (RECORD_TYPE, SECURITY_ID, SECURITY_REF_NOTE, SOURCE_SECURITY_TYPE, SOURCE_SECURITY_SUB_TYPE, CURRENCY, LOC_COUNTRY, LOC_ORG_CODE, TYPE, CERTIFICATE_NUMBER, NUMBER_OF_UNITS, STOCK_EXCHANGE_BOND_MARKET, STOCK_CODE_BOND_CODE, RECOGNIZED_EXCHANGE, IS_LEGAL_ENFORCE, IS_LEGAL_ENFORCE_DATE, SECURITY_PERFECTION_DATE, BORROWER_DEPENDENCY, IS_CGC_PLEDGED, CDS_NUMBER, SECURITY_REFERRED, CUSTODIAN_TYPE, SECURITY_CUSTODIAN, SECURITY_MATURITY_DATE, ISSUER_NAME,  STOCK_EXCHANGE_COUNTRY, LOCAL_EXCHANGE, BASEL_COMPLIANT_TEXT, EXCHANGE_CONTROL_OBTAINED, CHARGE_NATURE, CHARGE_AMOUNT, LEGAL_CHARGE_DATE, CHARGE_TYPE, UNIT_PRICE, UNIT_PRICE_CURRENCY, CAPPED_PRICE, COLLATERAL_STATUS, SOURCE_ID) NONRECOVERABLE INDEXING MODE AUTOSELECT

:end