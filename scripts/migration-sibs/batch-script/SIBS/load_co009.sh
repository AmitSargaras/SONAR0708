#!/bin/bash

. ../set_mig_env.sh $*

if [ -e "$FILE_PATH.ht" ]; then
	. ../hash_total.sh check "$FILE_PATH" "$FILE_PATH.ht" 243,15
fi

if [ ! "$IS_PROCEED" = "true" ]; then
	return
fi

"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF ASC MODIFIED BY NOROWWARNINGS TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L \( 1 1, 2 20, 21 25, 26 65, 66 70, 71 73, 74 76, 77 96, 97 116, 117 117, 118 217, 218 225, 226 226, 227 234, 235 242, 243 257, 258 265, 266 266, 267 267, 268 287, 288 327, 328 347, 348 357, 358 363, 364 403, 404 429, 430 469, 470 488, 489 528, 529 531, 532 532, 533 533, 534 548, 549 556, 557 559, 560 560, 561 561, 562 564, 565 584, 585 599, 600 607, 608 615, 616 623, 624 636, 637 649, 650 689, 690 729, 730 769, 770 784, 785 792, 793 793, 794 794, 795 795, 796 796, 797 797, 798 799, 800 800, 801 801\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".MIG_CO009_PT \(RECORD_TYPE, SECURITY_ID, CMS_SECURITY_SUBTYPE_ID, SECURITY_REF_NOTE, SOURCE_SECURITY_TYPE, SOURCE_SECURITY_SUB_TYPE, CURRENCY, LOC_COUNTRY, LOC_ORG_CODE, CUSTODIAN_TYPE, CUSTODIAN, SECURITY_EXPIRY_DATE, LEGAL_ENFORCEABILITY, LEGAL_ENFORCEABILITY_DATE, SECURITY_PERFECTION_DATE, SALE_PURCHASE_AGREEMENT_VALUE, SALE_PURCHASE_DATE, TITLE_TYPE, MASTER_TITLE, MASTER_TITLE_NUMBER, TITLE_NUMBER_PREFIX, TITLE_NUMBER, LOT_NO, POST_CODE, STATE_CODE, LAND_AREA, LAND_AREA_UOM, BUILT_UP_AREA, BUILD_AREA_UOM, TENURE, TENURE_UNIT, QUIT_RENT_RECEIPT, QUIT_RENT_AMT_PAID, QUIT_RENT_PAYMENT_DATE, PROPERTY_USAGE, ABANDONED_PROJECT, PROPERTY_COMPLETION_STATUS, PROPERTY_TYPE_CODE, AUCTIONEER, AUCTION_PRICE, AUCTION_DATE, CHATTEL_SOLD_DATE, PRI_CAVEAT_GUARANTEE_DATE, AMOUNT_REDEEM, UNIT_PRICE, PROPERTY_ADDRESS, PROPERTY_ADDRESS_2, PROPERTY_ADDRESS_3, ASSESSMENT_RATE, ASSESSMENT_PAYMENT_DATE, ASSESSMENT, EXCHANGE_CONTROL_OBTAINED, BORROWER_DEPENDENCY, IS_CGC_PLEDGED, IS_PHY_INSPECT, ENV_RISKY_STATUS, INDEPENDENT_VALUER_FLAG, COLLATERAL_STATUS\) NONRECOVERABLE INDEXING MODE AUTOSELECT