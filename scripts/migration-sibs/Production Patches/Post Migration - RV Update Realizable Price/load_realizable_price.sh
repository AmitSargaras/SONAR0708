#!/bin/bash

. ../setenv.sh
. ../connect.sh

FILE_PATH=$1
DUMP_PATH=$2
LOG_PATH=$3
if [ -z $1 ]; then
	echo "[error] Please specify input file"
	return
fi

"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF ASC MODIFIED BY TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L \(1 20, 21 39\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".MIG_SEC_REALIZABLE \(SECURITY_ID, NET_REALIZABLE_VALUE\) NONRECOVERABLE INDEXING MODE AUTOSELECT

# . ./load_realizable_price.sh $MSG_DIR/C0001SIBS $DUMPPATH/C0001SIBS.dmp $LOAD_LOG/C0001SIBS.log