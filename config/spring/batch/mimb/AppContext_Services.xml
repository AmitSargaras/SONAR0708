<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:aop="http://www.springframework.org/schema/aop"
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
			http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">

	<!--Limit File -->
	
	<bean name="mimbDelimitedLineWithTrailerTokenizer" class="org.springframework.batch.item.file.transform.PrefixMatchingCompositeLineTokenizer">
		<property name="tokenizers">
			<map>
				<entry key="D">
					<bean class="org.springframework.batch.item.file.transform.DelimitedLineTokenizer" />
				</entry>
				<entry key="T">
					<bean class="com.integrosys.cms.batch.common.ReturnNullLineTokenizer" />
				</entry>
			</map>
		</property>
	</bean>
	
	<bean name="mimbTransactionTemplate" class="org.springframework.transaction.support.TransactionTemplate">
		<property name="transactionManager" ref="txManager" />
	</bean>

	<bean name="mimbJdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
		<property name="dataSource" ref="ofaPool" />
	</bean>

	<bean id="mimbLimitInfoFileItemReader" class="org.springframework.batch.item.file.FlatFileItemReader" scope="prototype">
		<property name="resource" value="${resource.mimb.limit.feed.path}" />
		<property name="fieldSetMapper">
			<bean class="com.integrosys.cms.batch.mimb.limit.LimitInformationFieldSetMapperImpl" />
		</property>
		<property name="lineTokenizer" ref="mimbDelimitedLineWithTrailerTokenizer" />
		<property name="firstLineIsHeader" value="true" />
	</bean>

	<bean id="mimbLimitInfoLoaderBatchJob" class="com.integrosys.cms.batch.mimb.limit.LimitInformationFileLoader">
		<property name="limitInfoFileReader" ref="mimbLimitInfoFileItemReader" />
		<property name="limitInfoFileDAO" ref="limitInfoFileDAO" />
		<property name="feedBatchSize" value="${feed.batch.size}" />
		<property name="transactionTemplate" ref="mimbTransactionTemplate" />
		<property name="batchFeedErrorLogger">
			<bean class="com.integrosys.cms.batch.common.FileSystemBatchFeedErrorLogger">
				<property name="logFileLocation" value="${log.mimb.limit.feed.path}" />
			</bean>
		</property>
		<property name="jdbcTemplate" ref="mimbJdbcTemplate" />
		<property name="tempTableName" value="SI_TEMP_MIMB_CA003" />
		<property name="validationProcedureName" value="SI_VALIDATE_TEMP_MIMB_CA003" />
		<property name="runProcedureName" value="SI_RUN_TEMP_MIMB_CA003" />
	</bean>

	<!--Collateral Marketable File -->
	
	<bean id="mimbCollateralMarketableFileItemReader" class="org.springframework.batch.item.file.FlatFileItemReader" scope="prototype">
		<property name="resource" value="${resource.mimb.col.marketsec.feed.path}" />
		<property name="fieldSetMapper">
			<bean class="com.integrosys.cms.batch.mimb.collateral.CollateralMarketableFieldSetMapperImpl" />
		</property>
		<property name="lineTokenizer" ref="mimbDelimitedLineWithTrailerTokenizer" />
		<property name="firstLineIsHeader" value="true" />
	</bean>

	<bean id="mimbCollateralMarketableSecLoaderBatchJob" class="com.integrosys.cms.batch.mimb.collateral.CollateralMarketableFileLoader">
		<property name="collateralMarketableFileReader" ref="mimbCollateralMarketableFileItemReader" />
		<property name="collateralFileDAO" ref="collateralFileDAO" />
		<property name="feedBatchSize" value="${feed.batch.size}" />
		<property name="transactionTemplate" ref="mimbTransactionTemplate" />
		<property name="batchFeedErrorLogger">
			<bean class="com.integrosys.cms.batch.common.FileSystemBatchFeedErrorLogger">
				<property name="logFileLocation" value="${log.mimb.col.marketsec.feed.path}" />
			</bean>
		</property>
		<property name="jdbcTemplate" ref="mimbJdbcTemplate" />
		<property name="tempTableName" value="SI_TEMP_MIMB_CO003" />
		<property name="validationProcedureName" value="SI_VALIDATE_TEMP_MIMB_CO003" />
		<property name="runProcedureName" value="SI_RUN_TEMP_MIMB_CO003" />
	</bean>

	<!-- Collateral Cash File -->
	
	<bean id="mimbCollateralCashFileItemReader" class="org.springframework.batch.item.file.FlatFileItemReader" scope="prototype">
		<property name="resource" value="${resource.mimb.col.cash.feed.path}" />
		<property name="fieldSetMapper">
			<bean class="com.integrosys.cms.batch.mimb.collateral.CollateralCashFieldSetMapperImpl" />
		</property>
		<property name="lineTokenizer" ref="mimbDelimitedLineWithTrailerTokenizer" />
		<property name="firstLineIsHeader" value="true" />
	</bean>

	<bean id="mimbCollateralCashFileBatchJob" class="com.integrosys.cms.batch.mimb.collateral.CollateralCashFileLoader">
		<property name="collateralCashFileReader" ref="mimbCollateralCashFileItemReader" />
		<property name="collateralFileDAO" ref="collateralFileDAO" />
		<property name="feedBatchSize" value="${feed.batch.size}" />
		<property name="transactionTemplate" ref="mimbTransactionTemplate" />
		<property name="batchFeedErrorLogger">
			<bean class="com.integrosys.cms.batch.common.FileSystemBatchFeedErrorLogger">
				<property name="logFileLocation" value="${log.mimb.col.cash.feed.path}" />
			</bean>
		</property>
		<property name="jdbcTemplate" ref="mimbJdbcTemplate" />
		<property name="tempTableName" value="SI_TEMP_MIMB_CO004" />
		<property name="validationProcedureName" value="SI_VALIDATE_TEMP_MIMB_CO004" />
		<property name="runProcedureName" value="SI_RUN_TEMP_MIMB_CO004" />
	</bean>	

	<!-- Customer File -->
	
	<bean id="mimbCustomerInfoFileItemReader" class="org.springframework.batch.item.file.FlatFileItemReader" scope="prototype">
		<property name="resource" value="${resource.mimb.customer.feed.path}" />
		<property name="fieldSetMapper">
			<bean class="com.integrosys.cms.batch.mimb.customer.CustomerInfoFieldSetMapperImpl" />
		</property>
		<property name="lineTokenizer" ref="mimbDelimitedLineWithTrailerTokenizer" />
		<property name="firstLineIsHeader" value="true" />
	</bean>

	<bean id="mimbCustomerInfoLoaderBatchJob" class="com.integrosys.cms.batch.mimb.customer.CustomerInfoFileLoader">
		<property name="customerInfoFileReader" ref="mimbCustomerInfoFileItemReader" />
		<property name="customerInfoFileDAO" ref="customerInfoDAO" />
		<property name="feedBatchSize" value="${feed.batch.size}" />
		<property name="transactionTemplate" ref="mimbTransactionTemplate" />
		<property name="batchFeedErrorLogger">
			<bean class="com.integrosys.cms.batch.common.FileSystemBatchFeedErrorLogger">
				<property name="logFileLocation" value="${log.mimb.customer.feed.path}" />
			</bean>
		</property>
		<property name="jdbcTemplate" ref="mimbJdbcTemplate" />
		<property name="tempTableName" value="SI_TEMP_MIMB_CU002" />
		<property name="validationProcedureName" value="SI_VALIDATE_TEMP_MIMB_CU002" />
		<property name="runProcedureName" value="SI_RUN_TEMP_MIMB_CU002" />
	</bean>

</beans>