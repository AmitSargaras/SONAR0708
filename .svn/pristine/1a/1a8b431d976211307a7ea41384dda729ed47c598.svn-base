@echo off

call set_mig_env.cmd %*

IF NOT "%IS_PROCEED%"=="true" (
	goto end
)

rem SEC
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDELX7C DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_AB111 (CIF_NUMBER,FAC_DESC,SOURCE_SECURITY_ID,SECURITY_TYPE,SECURITY_SUB_TYPE,SECURITY_CURRENCY,SECURITY_LOCATION,SECURITY_ORGANISATION,SECURITY_CUSTODIAN_TYPE,SECURITY_CUSTODIAN_VALUE,SECURITY_MATURITY_DATE,SECURITY_PERFECTION_DATE,LEGAL_ENFORCEABILITY_IND,LEGAL_ENFORCEABILITY_DATE,SECURITY_REF_NOTE,EXCHANGE_CONTROL_OBTAINED,PHYSICAL_INSPECTION_IND,LAST_PHYSICAL_INSPECTION_DATE,NEXT_PHYSICAL_INSPECTION_DATE,PHYSICAL_INSPECTION_FREQ_UNIT,PHYSICAL_INSPECTION_FREQ_UOM,SEC_ENVIRONMENTAL_RISKY_IND,DATE_SEC_CONFIRM_ENV_RISKY,REMARKS_SEC_ENV_RISKY,ASSET_TYPE,BUILT_YEAR,PURCHASE_PRICE,PURCHASE_DATE,INSURER,VESSEL_NAME,FLAG_REGISTERED,VESSEL_STATE,EXPECTED_OCCUPANCY_DATE,EXPECTED_OCCUPANCY,OCCUPANCY_TYPE,BUILDER,MAIN_REGISTRATION,LENGTH,WIDTH,DEPTH,DECK_LOADING,DECK_WEIGHT,SIDE_BOARD,BOW,DECK,DECK_THICKNESS,BOTTOM,WINCH_DRIVE,BHP,SPEED,ANCHOR,ANCHOR_DRIVE,CLASS_SOCIETY,CONSTRUCTION_COUNTRY,CONSTRUCTION_PLACE,VESSEL_USE,CHARTER_CONTRACT,CHARTERER_NAME,CHARTER_PERIOD,CHARTER_PERIOD_UOM,CHARTER_AMT,CHARTER_CCY,CHARTER_RATE,CHARTER_RATE_OTHERS,CHARTER_REMARKS,ASSET_DESC) FOR EXCEPTION "%DB_SCHEMA%".MIG_AB111_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_AB111 IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_AB111 USE "%DB_SCHEMA%".MIG_AB111_ERR

rem CHARGE
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDELX7C DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (4,2,68,69,70,71,72,73,74,75,76,77)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_CHARGE_AB111 (SOURCE_SECURITY_ID, SOURCE_LIMIT_ID, SECURITY_RANKING, CHARGE_TYPE, NATURE_OF_CHARGE, CHARGE_CURRENCY, CHARGE_AMT, DATE_LEGALLY_CHARGE, PRIOR_CHARGEE, PRIOR_CHARGE_TYPE, PRIOR_CHARGE_CCY, PRIOR_CHARGE_AMT) FOR EXCEPTION "%DB_SCHEMA%".MIG_CHARGE_AB111_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_CHARGE_AB111 IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_CHARGE_AB111 USE "%DB_SCHEMA%".MIG_CHARGE_AB111_ERR

rem pledgor
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDELX7C DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (1,4,2,78,79,80,81,82)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_PLEDGOR_AB111 (CIF_NUMBER, SOURCE_SECURITY_ID, SOURCE_LIMIT_ID, IS_BORROWER_PLEDGOR, CIF_PLEDGOR1, CIF_PLEDGOR2, CIF_PLEDGOR3, CIF_PLEDGOR4) FOR EXCEPTION "%DB_SCHEMA%".MIG_PLEDGOR_AB111_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE	

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_PLEDGOR_AB111 IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_PLEDGOR_AB111 USE "%DB_SCHEMA%".MIG_PLEDGOR_AB111_ERR

rem VALUATION
db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDELX7C DUMPFILE="%DUMP_PATH%" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P (4,83,84,85,86,87,88,89,90)  MESSAGES "%LOG_PATH%" INSERT INTO "%DB_SCHEMA%".MIG_VAL_AB111 (SOURCE_SECURITY_ID, VALUATION_DATE, VALUATION_CCY, VALUATION_OMV, VALUER, VALUATION_FSV, COMMENTS, RESERVE_PRICE, RESERVE_PRICE_DATE) FOR EXCEPTION "%DB_SCHEMA%".MIG_VAL_AB111_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

db2 SET INTEGRITY FOR "%DB_SCHEMA%".MIG_VAL_AB111 IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "%DB_SCHEMA%".MIG_VAL_AB111 USE "%DB_SCHEMA%".MIG_VAL_AB111_ERR



:end
