<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:aop="http://www.springframework.org/schema/aop"
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
			http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">

	<bean id="semafacilityFlatFileItemReader" class="org.springframework.batch.item.file.FlatFileItemReader" scope="prototype">
		<property name="resource" value="${resource.sema.facility.feed.path}" />
		<property name="fieldSetMapper">
			<bean class="com.integrosys.cms.batch.sema.FacilityFileSetFileMapperImpl">
				<property name="dateFormat" value="${format.date.yyyymmdd}" />
				<property name="outstandingBalanceDecimal" value="${format.decimal.point.sema.facility.outstanding}" />
			</bean>
		</property>
		<property name="firstLineIsHeader" value="true" />
		<property name="lineTokenizer">
			<bean class="org.springframework.batch.item.file.transform.PrefixMatchingCompositeLineTokenizer">
				<property name="tokenizers">
					<map>
						<entry key="D">
							<bean class="org.springframework.batch.item.file.transform.FixedLengthTokenizer">
								<property name="columns" value="1-1,2-21,22-41,42-61,62-69,70-70,71-88,89-95,96-110,111-111,112-112" />
							</bean>
						</entry>
						<entry key="T">
							<bean class="com.integrosys.cms.batch.common.ReturnNullLineTokenizer" />
						</entry>
					</map>
				</property>
			</bean>
		</property>
	</bean>

	<bean id="semaFacilityLoaderBatchJob" class="com.integrosys.cms.batch.sema.FacilityFileLoader">
		<property name="facilityFileReader" ref="semafacilityFlatFileItemReader" />
		<property name="facilityFileDAO" ref="facilityFileDao" />
		<property name="feedBatchSize" value="${feed.batch.size}" />
		<property name="transactionTemplate">
			<bean class="org.springframework.transaction.support.TransactionTemplate">
				<property name="transactionManager" ref="txManager" />
			</bean>
		</property>
		<property name="batchFeedErrorLogger">
			<bean class="com.integrosys.cms.batch.common.FileSystemBatchFeedErrorLogger">
				<property name="logFileLocation" value="${log.sema.facility.feed.path}" />
			</bean>
		</property>
		<property name="jdbcTemplate">
			<bean class="org.springframework.jdbc.core.JdbcTemplate">
				<property name="dataSource" ref="ofaPool" />
			</bean>
		</property>
		<property name="tempTableName" value="SI_TEMP_SEMA_CA002" />
		<property name="validationProcedureName" value="SI_VALIDATE_TEMP_SEMA_CA002" />
		<property name="runProcedureName" value="SI_RUN_TEMP_SEMA_CA002" />
	</bean>

</beans>