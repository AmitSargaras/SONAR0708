/* Patching for application date, approval date, offer date, offer accepted date - EONCMSPRD-1477 */

drop table PATCH_APP_OFF_DATE_MO;

CREATE TABLE PATCH_APP_OFF_DATE_MO (
	CMS_LSP_APPR_LMTS_ID	BIGINT,
	CIF_ID 					VARCHAR(19),  
	AA_NUMBER				VARCHAR(35),
	LOS_AA_NUMBER			VARCHAR(35),
	LIMIT_ID				VARCHAR(43),
	APPROVED_DATE			TIMESTAMP,
	APPLICATION_DATE		TIMESTAMP,
    OFFER_DATE		        TIMESTAMP,
    OFFER_ACCEPTED_DATE	    TIMESTAMP
) in CMS_MIG index in CMS_MIG_INDEX;

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- insert into temporary table 
="insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPROVED_DATE, APPLICATION_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('"&B6&"', '"&C6&"', '"&D6&"', '"&E6&"', '"&TEXT(M6,"yyyy-mm-dd-hh.mm.ss.00")&"', '"&TEXT(N6,"yyyy-mm-dd-hh.mm.ss.00")&"', '"&TEXT(O6,"yyyy-mm-dd-hh.mm.ss.00")&"', '"&TEXT(P6,"yyyy-mm-dd-hh.mm.ss.00")&"');"

insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10173366', '701203332784', 'MO-800528-031105-000001', '7012033327847171', '2003-07-15-00.00.00.00', '2003-07-15-00.00.00.00', '2003-07-27-00.00.00.00', '2003-09-08-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190132261', '703503335911', 'MO-800559-031128-000001', '7035033359117171', '2003-08-19-00.00.00.00', '2003-08-23-00.00.00.00', '2003-08-30-00.00.00.00', '2003-03-09-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('30070488', '202003279981', 'MO-802020-031021-000001', '2020032799812201', '2003-02-07-00.00.00.00', '2003-02-18-00.00.00.00', '2003-03-31-00.00.00.00', '2003-04-07-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80067730', '702003334144', 'MO-807020-040131-000002', '7020033341447171', '2003-08-13-00.00.00.00', '2003-08-19-00.00.00.00', '2003-08-22-00.00.00.00', '2003-08-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130187567', '702003334145', 'MO-807020-040131-000003', '7020033341457171', '2003-12-01-00.00.00.00', '2003-12-17-00.00.00.00', '2003-12-31-00.00.00.00', '2004-01-02-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('20028929', '702004334148', 'MO-807020-040209-000001', '7020043341487171', '2004-01-21-00.00.00.00', '2004-01-31-00.00.00.00', '2004-02-07-00.00.00.00', '2004-02-12-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120203903', '702004334147', 'MO-807020-040131-000005', '7020043341477171', '2004-01-06-00.00.00.00', '2004-01-12-00.00.00.00', '2004-01-16-00.00.00.00', '2004-01-19-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('250064621', '703903336168', 'MO-800553-040205-000001', '7039033361687171', '2003-09-17-00.00.00.00', '2003-09-29-00.00.00.00', '2003-10-03-00.00.00.00', '2003-10-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190169164', '703903336172', 'MO-800553-040213-000001', '7039033361727171', '2003-08-06-00.00.00.00', '2003-07-14-00.00.00.00', '2003-08-23-00.00.00.00', '2003-08-29-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10132097', '703903336173', 'MO-800553-040213-000002', '7039033361737171', '2003-08-06-00.00.00.00', '2003-08-18-00.00.00.00', '2003-08-23-00.00.00.00', '2003-08-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190170508', '703903336175', 'MO-800553-040217-000003', '7039033361757171', '2003-07-06-00.00.00.00', '2003-07-14-00.00.00.00', '2003-08-23-00.00.00.00', '2003-08-29-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190170631', '703903336174', 'MO-800553-040217-000002', '7039033361747171', '2003-06-06-00.00.00.00', '2003-07-13-00.00.00.00', '2003-08-12-00.00.00.00', '2003-08-13-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120231300', '703903336180', 'MO-800553-040301-000001', '7039033361807171', '2003-08-06-00.00.00.00', '2003-03-07-00.00.00.00', '2003-08-23-00.00.00.00', '2003-08-23-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('50020109', '703903336183', 'MO-800553-040312-000001', '7039033361837171', '2003-10-15-00.00.00.00', '2003-10-20-00.00.00.00', '2003-10-22-00.00.00.00', '2003-10-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140124713', '703903336186', 'MO-800553-040313-000002', '7039033361867171', '2003-08-06-00.00.00.00', '2003-09-07-00.00.00.00', '2003-08-23-00.00.00.00', '2003-09-04-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130187228', '703903336185', 'MO-800553-040313-000001', '7039033361857171', '2003-02-09-00.00.00.00', '2003-09-09-00.00.00.00', '2003-09-23-00.00.00.00', '2003-09-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('230082491', '703903336193', 'MO-800553-040507-000002', '7039033361937171', '2003-02-05-00.00.00.00', '2003-05-16-00.00.00.00', '2003-05-27-00.00.00.00', '2003-06-02-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('150037076', '703903336192', 'MO-800553-040507-000001', '7039033361927171', '2003-01-04-00.00.00.00', '2003-05-16-00.00.00.00', '2003-09-04-00.00.00.00', '2003-09-04-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140126241', '703904336179', 'MO-800553-040226-000002', '7039043361797171', '2003-08-06-00.00.00.00', '2003-07-14-00.00.00.00', '2003-08-23-00.00.00.00', '2003-09-05-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80075691', '703903336178', 'MO-800553-040226-000001', '7039033361787171', '2003-09-16-00.00.00.00', '2003-09-29-00.00.00.00', '2003-10-03-00.00.00.00', '2003-10-08-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190218846', '201503278250', 'MO-800049-040528-000005', '2015032782502101', '2003-07-18-00.00.00.00', '2003-08-09-00.00.00.00', '2003-08-18-00.00.00.00', '2003-08-19-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('30132888', '201503278245', 'MO-800049-030910-000002', '2015032782452111', '2003-08-14-00.00.00.00', '2003-09-02-00.00.00.00', '2003-09-09-00.00.00.00', '2003-09-10-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180065052', '701503333455', 'MO-800549-030912-000002', '7015033334557171', '2003-09-03-00.00.00.00', '2003-09-10-00.00.00.00', '2003-09-10-00.00.00.00', '2003-09-22-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200026342', '701503333452', 'MO-800549-031003-000001', '7015033334527171', '2003-09-27-00.00.00.00', '2003-10-02-00.00.00.00', '2003-10-07-00.00.00.00', '2003-10-08-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130154694', '701502333407', 'MO-800549-031224-000001', '7015023334077171', '2002-09-26-00.00.00.00', '2002-10-10-00.00.00.00', '2002-10-18-00.00.00.00', '2002-10-21-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('70029232', '701504333437', 'MO-800549-040227-000001', '7015043334377171', '2002-10-02-00.00.00.00', '2002-10-25-00.00.00.00', '2002-11-08-00.00.00.00', '2002-11-09-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80085439', '704202336427', 'MO-807042-020528-000002', '7042023364277171', '2002-05-28-00.00.00.00', '2002-05-28-00.00.00.00', '2002-06-05-00.00.00.00', '2002-06-24-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180053013', '704203336399', 'MO-807042-030326-000002', '7042033363997171', '2003-01-30-00.00.00.00', '2003-03-26-00.00.00.00', '2003-03-25-00.00.00.00', '2003-03-29-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140159657', '704203336431', 'MO-807042-040408-000003', '7042033364317171', '2003-06-23-00.00.00.00', '2003-07-04-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-22-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('60041074', '704203336428', 'MO-807042-030624-000001', '7042033364287171', '2003-06-24-00.00.00.00', '2003-07-01-00.00.00.00', '2003-07-16-00.00.00.00', '2003-07-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80097761', '704203336404', 'MO-807042-031223-000001', '7042033364047171', '2003-07-26-00.00.00.00', '2003-08-05-00.00.00.00', '2003-08-09-00.00.00.00', '2003-08-12-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140159659', '704203336430', 'MO-807042-040408-000002', '7042033364307171', '2003-06-23-00.00.00.00', '2003-06-30-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-22-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('110124213', '704203336429', 'MO-807042-040408-000001', '7042033364297171', '2003-06-18-00.00.00.00', '2003-06-23-00.00.00.00', '2003-07-16-00.00.00.00', '2003-07-25-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('60041074', '704203336428', 'MO-807042-030624-000001', '7042033364287170', '2003-06-24-00.00.00.00', '2003-07-01-00.00.00.00', '2003-07-16-00.00.00.00', '2003-07-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80085439', '704202336427', 'MO-807042-020528-000002', '7042023364277170', '2002-05-28-00.00.00.00', '2002-05-28-00.00.00.00', '2002-06-05-00.00.00.00', '2002-06-24-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180053013', '704203336399', 'MO-807042-030326-000002', '7042033363997170', '2003-01-30-00.00.00.00', '2003-03-26-00.00.00.00', '2003-03-25-00.00.00.00', '2003-03-29-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('230084619', '202704282951', 'MO-802027-040408-000001', '2027042829512201', '2002-08-16-00.00.00.00', '2002-09-20-00.00.00.00', '2002-09-30-00.00.00.00', '2002-10-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120277466', '202704282953', 'MO-802027-040414-000001', '2027042829532701', '2003-08-27-00.00.00.00', '2003-09-29-00.00.00.00', '2003-09-30-00.00.00.00', '2003-09-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10170244', '703802336119', 'MO-807038-030523-000001', '7038023361197171', '2002-12-17-00.00.00.00', '2002-12-20-00.00.00.00', '2003-01-26-00.00.00.00', '2003-01-28-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140136438', '703802336127', 'MO-807038-040106-000001', '7038023361277171', '2002-06-25-00.00.00.00', '2002-06-27-00.00.00.00', '2002-08-07-00.00.00.00', '2002-08-07-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130234414', '703802336117', 'MO-807038-030929-000001', '7038023361177171', '2002-09-09-00.00.00.00', '2002-09-20-00.00.00.00', '2003-03-03-00.00.00.00', '2003-05-03-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('40026287', '703803336123', 'MO-807038-031201-000001', '7038033361237171', '2003-03-04-00.00.00.00', '2003-04-16-00.00.00.00', '2003-04-21-00.00.00.00', '2003-04-23-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('80057735', '703803336130', 'MO-807038-030902-000001', '7038033361307171', '2003-04-06-00.00.00.00', '2003-06-18-00.00.00.00', '2003-06-19-00.00.00.00', '2003-11-07-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('20035774', '703803336129', 'MO-807038-040113-000001', '7038033361297331', '2003-03-06-00.00.00.00', '2003-12-06-00.00.00.00', '2003-10-06-00.00.00.00', '2003-06-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('110089627', '703803336126', 'MO-807038-031215-000001', '7038033361267171', '2003-07-04-00.00.00.00', '2003-04-16-00.00.00.00', '2003-05-24-00.00.00.00', '2003-05-25-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120198555', '201703278958', 'MO-802017-031215-000001', '2017032789582201', '2003-11-14-00.00.00.00', '2003-11-24-00.00.00.00', '2003-11-27-00.00.00.00', '2003-11-28-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10128215', '201703278975', 'MO-802017-031231-000001', '2017032789752201', '2003-12-18-00.00.00.00', '2003-12-23-00.00.00.00', '2003-12-23-00.00.00.00', '2003-12-27-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120180724', '201704278988', 'MO-802017-040329-000001', '2017042789882201', '2004-03-03-00.00.00.00', '2004-03-09-00.00.00.00', '2004-03-10-00.00.00.00', '2004-03-19-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190154654', '701703333726', 'MO-807017-031107-000001', '7017033337267171', '2003-10-22-00.00.00.00', '2003-10-28-00.00.00.00', '2003-11-04-00.00.00.00', '2003-11-06-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('70032587', '701703333728', 'MO-807017-031122-000001', '7017033337287171', '2003-11-14-00.00.00.00', '2003-11-20-00.00.00.00', '2003-11-21-00.00.00.00', '2003-11-22-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190187477', '701703333743', 'MO-807017-031209-000001', '7017033337437171', '2003-11-18-00.00.00.00', '2003-11-28-00.00.00.00', '2003-12-01-00.00.00.00', '2003-12-06-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140117825', '701703333732', 'MO-807017-031222-000001', '7017033337327171', '2003-03-12-00.00.00.00', '2003-12-15-00.00.00.00', '2003-12-15-00.00.00.00', '2003-12-15-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200152542', '701703333747', 'MO-807017-031223-000003', '7017033337477171', '2003-05-12-00.00.00.00', '2003-12-10-00.00.00.00', '2003-12-17-00.00.00.00', '2003-12-18-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140151930', '701703333730', 'MO-807017-031223-000001', '7017033337307171', '2003-10-12-00.00.00.00', '2003-12-16-00.00.00.00', '2003-12-16-00.00.00.00', '2003-12-18-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200152956', '701703333734', 'MO-807017-031224-000001', '7017033337347171', '2003-12-12-00.00.00.00', '2003-12-18-00.00.00.00', '2003-12-22-00.00.00.00', '2003-12-24-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200159831', '701704333737', 'MO-807017-040129-000001', '7017043337377171', '2004-05-01-00.00.00.00', '2004-01-09-00.00.00.00', '2004-01-13-00.00.00.00', '2004-01-16-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180086110', '701704333749', 'MO-807017-040410-000002', '7017043337497171', '2004-03-19-00.00.00.00', '2004-03-26-00.00.00.00', '2004-04-02-00.00.00.00', '2004-04-09-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('160051638', '701704333742', 'MO-807017-040416-000001', '7017043337427171', '2004-01-04-00.00.00.00', '2004-04-06-00.00.00.00', '2004-04-06-00.00.00.00', '2004-04-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('250072002', '701704333748', 'MO-807017-040410-000001', '7017043337487171', '2004-03-24-00.00.00.00', '2004-03-29-00.00.00.00', '2004-04-01-00.00.00.00', '2004-04-05-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('20025021', '701703333723', 'MO-807017-030930-000001', '7017033337237171', '2003-09-17-00.00.00.00', '2003-09-22-00.00.00.00', '2003-09-25-00.00.00.00', '2003-10-06-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('150037003', '701704333746', 'MO-807017-040506-000001', '7017043337467171', '2004-04-24-00.00.00.00', '2004-04-29-00.00.00.00', '2004-05-05-00.00.00.00', '2004-05-06-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140117825', '701703333732', 'MO-807017-031222-000001', '7017033337327171', '2003-03-12-00.00.00.00', '2003-12-15-00.00.00.00', '2003-12-15-00.00.00.00', '2003-12-15-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180003322', '704003336226', 'MO-807040-040614-000001', '7040033362267171', '2003-12-03-00.00.00.00', '2003-03-31-00.00.00.00', '2003-04-17-00.00.00.00', '2003-04-17-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140158239', '704003336207', 'MO-807040-031021-000001', '7040033362077171', '2003-04-15-00.00.00.00', '2003-04-23-00.00.00.00', '2003-05-26-00.00.00.00', '2003-05-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200133237', '704003336206', 'MO-807040-031003-000003', '7040033362067171', '2003-10-07-00.00.00.00', '2003-07-17-00.00.00.00', '2003-08-05-00.00.00.00', '2003-08-05-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130162570', '704003336205', 'MO-807040-031003-000002', '7040033362057171', '2003-06-22-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('250074240', '704003336227', 'MO-807040-040614-000002', '7040033362277171', '2003-10-12-00.00.00.00', '2004-01-28-00.00.00.00', '2004-01-28-00.00.00.00', '2004-01-28-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140144207', '704003336223', 'MO-807040-040604-000001', '7040033362237171', '2003-08-05-00.00.00.00', '2003-05-31-00.00.00.00', '2003-05-31-00.00.00.00', '2003-05-31-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140158239', '704003336207', 'MO-807040-031021-000001', '7040033362077171', '2003-04-15-00.00.00.00', '2003-04-23-00.00.00.00', '2003-05-26-00.00.00.00', '2003-05-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('140144207', '704003336223', 'MO-807040-040604-000001', '7040033362237171', '2003-08-05-00.00.00.00', '2003-05-24-00.00.00.00', '2003-05-31-00.00.00.00', '2003-05-31-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10171989', '704003336225', 'MO-807040-040604-000003', '7040033362257171', '2003-04-15-00.00.00.00', '2003-04-18-00.00.00.00', '2003-05-24-00.00.00.00', '2003-05-24-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('190217290', '704003336204', 'MO-807040-031003-000001', '7040033362047171', '2003-05-06-00.00.00.00', '2003-06-11-00.00.00.00', '2003-06-27-00.00.00.00', '2003-06-27-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('20031346', '704003336224', 'MO-807040-040604-000002', '7040033362247171', '2003-06-16-00.00.00.00', '2003-06-25-00.00.00.00', '2003-07-16-00.00.00.00', '2003-07-16-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('180003322', '704003336226', 'MO-807040-040614-000001', '7040033362267171', '2003-12-03-00.00.00.00', '2003-04-17-00.00.00.00', '2003-04-17-00.00.00.00', '2003-04-17-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('250074240', '704003336227', 'MO-807040-040614-000002', '7040033362277171', '2003-10-12-00.00.00.00', '2004-01-28-00.00.00.00', '2004-01-28-00.00.00.00', '2004-01-28-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130162570', '704003336205', 'MO-807040-031003-000002', '7040033362057171', '2003-06-22-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-14-00.00.00.00', '2003-07-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('110081340', '6097000081', 'MO-800060-980529-000001', '60970000811101', '1995-09-26-00.00.00.00', '1995-10-19-00.00.00.00', '1995-10-27-00.00.00.00', '1995-10-27-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200163126', '6097000110', 'MO-800060-980529-000002', '60970001101101', '1997-02-28-00.00.00.00', '1997-03-17-00.00.00.00', '1997-03-23-00.00.00.00', '1997-04-16-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130238744', '201803279637', 'MO-802018-030826-000001', '2018032796372701', '2003-08-13-00.00.00.00', '2003-08-19-00.00.00.00', '2003-08-21-00.00.00.00', '2003-08-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('130238970', '201803279654', 'MO-802018-030808-000001', '2018032796542701', '2003-07-29-00.00.00.00', '2003-08-05-00.00.00.00', '2003-08-06-00.00.00.00', '2003-08-08-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120295942', '201803279655', 'MO-802018-030830-000001', '2018032796552701', '2003-07-26-00.00.00.00', '2003-08-04-00.00.00.00', '2003-08-26-00.00.00.00', '2003-08-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('110124395', '201803279661', 'MO-802018-030814-000001', '2018032796612701', '2003-08-12-00.00.00.00', '2003-08-13-00.00.00.00', '2003-08-13-00.00.00.00', '2003-08-14-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200211146', '201803279649', 'MO-802018-031104-000001', '2018032796492701', '2003-10-22-00.00.00.00', '2003-10-28-00.00.00.00', '2003-10-30-00.00.00.00', '2003-11-04-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('30161597', '201804279657', 'MO-802018-040126-000001', '2018042796572701', '2004-01-08-00.00.00.00', '2004-01-12-00.00.00.00', '2004-01-19-00.00.00.00', '2004-01-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200212481', '201803279638', 'MO-802018-030412-000002', '2018032796382111', '2003-04-02-00.00.00.00', '2003-04-04-00.00.00.00', '2003-04-07-00.00.00.00', '2003-04-12-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('160059482', '201803279660', 'MO-802018-030701-000001', '2018032796602101', '2003-04-17-00.00.00.00', '2003-05-22-00.00.00.00', '2003-06-20-00.00.00.00', '2003-06-30-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120243328', '701804334056', 'MO-807018-040304-000001', '7018043340567171', '2004-02-12-00.00.00.00', '2004-02-25-00.00.00.00', '2004-03-01-00.00.00.00', '2004-03-03-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('120246135', '701804334055', 'MO-807018-040331-000001', '7018043340557141', '2004-02-07-00.00.00.00', '2004-03-08-00.00.00.00', '2004-03-09-00.00.00.00', '2004-03-17-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('10140405', '701804334058', 'MO-807018-040326-000001', '7018043340587171', '2004-03-17-00.00.00.00', '2004-03-22-00.00.00.00', '2004-03-22-00.00.00.00', '2004-03-26-00.00.00.00');
insert into PATCH_APP_OFF_DATE_MO (CIF_ID, AA_NUMBER, LOS_AA_NUMBER, LIMIT_ID, APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) values ('200163126', '6097000110', 'MO-800060-980529-000002', '60970001101101', '1997-02-28-00.00.00.00', '1997-03-17-00.00.00.00', '1997-03-23-00.00.00.00', '1997-04-16-00.00.00.00');

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- Update primary key for limit tables
update PATCH_APP_OFF_DATE_MO pth
set CMS_LSP_APPR_LMTS_ID = (select CMS_LSP_APPR_LMTS_ID from SCI_LSP_APPR_LMTS lmt
                            where lmt.LMT_LE_ID = pth.CIF_ID
                            and lmt.LMT_BCA_REF_NUM = pth.AA_NUMBER
                            and lmt.LMT_ID = pth.LIMIT_ID)
where exists (select 1 from SCI_LSP_APPR_LMTS lmt
                where lmt.LMT_LE_ID = pth.CIF_ID
                and lmt.LMT_BCA_REF_NUM = pth.AA_NUMBER
                and lmt.LMT_ID = pth.LIMIT_ID fetch first row only);

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- Update actual tables
update cms_fac_general facgen
set (APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) = 
(select pth.APPLICATION_DATE, pth.APPROVED_DATE, pth.OFFER_DATE, pth.OFFER_ACCEPTED_DATE
		from PATCH_APP_OFF_DATE_MO pth, CMS_FACILITY_MASTER facmas 
		where pth.CMS_LSP_APPR_LMTS_ID = facmas.CMS_LSP_APPR_LMTS_ID
		and facmas.ID = facgen.CMS_FAC_MASTER_ID fetch first row only)
where exists (select 1 from PATCH_APP_OFF_DATE_MO pth1, CMS_FACILITY_MASTER facmas1
                where pth1.CMS_LSP_APPR_LMTS_ID = facmas1.CMS_LSP_APPR_LMTS_ID
                and facmas1.ID = facgen.CMS_FAC_MASTER_ID);

-- Update staging tables
update cms_stg_fac_general facgen
set (APPLICATION_DATE, APPROVED_DATE, OFFER_DATE, OFFER_ACCEPTED_DATE) = 
(select pth.APPLICATION_DATE, pth.APPROVED_DATE, pth.OFFER_DATE, pth.OFFER_ACCEPTED_DATE
		from PATCH_APP_OFF_DATE_MO pth, CMS_STG_FACILITY_MASTER facmas 
		where pth.CMS_LSP_APPR_LMTS_ID = facmas.CMS_LSP_APPR_LMTS_ID
		and facmas.ID = facgen.CMS_FAC_MASTER_ID fetch first row only)
where exists (select 1 from PATCH_APP_OFF_DATE_MO pth1, CMS_STG_FACILITY_MASTER facmas1
                where pth1.CMS_LSP_APPR_LMTS_ID = facmas1.CMS_LSP_APPR_LMTS_ID
                and facmas1.ID = facgen.CMS_FAC_MASTER_ID);
			
				
				
				
