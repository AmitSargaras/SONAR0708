#!/bin/bash

. ./setenv.sh
. ./connect.sh

FILE_PATH=$1
DUMP_PATH=$2
LOG_PATH=$3
if [ -z $1 ]; then
	echo "[error] Please specify input file"
	return
fi

echo `date +"%Y/%m/%d %H:%M:%S"` Loading Insurance Policy ... 
"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF DEL MODIFIED BY DATEFORMAT=\"DDMMYYYY\" TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y coldel0x7C METHOD P \(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".PATCH_CO016_IN \(AA_NUMBER, SECURITY_REF_NOTE, POLICY_SEQ_NO, POLICY_NUMBER, INSURER_NAME, INSURER_NAME_CODE, BANK_CUST_ARRANGE_INS_IND, INSURANCE_TYPE_CODE, EFFECTIVE_DATE, EXPIRY_DATE, INSURED_AMT, TYPE_OF_BUILDING, BUILDING_OCCUPATION_CODE, WALL, ROOF, TYPE_OF_FLOOR, NUMBER_OF_STOREY\) NONRECOVERABLE INDEXING MODE AUTOSELECT

echo `date +"%Y/%m/%d %H:%M:%S"` End Scripts ... 

# . ./load_inspol.sh $MSG_DIR/C0001SIBS $DUMPPATH/C0001SIBS.dmp $LOAD_LOG/C0001SIBS.log