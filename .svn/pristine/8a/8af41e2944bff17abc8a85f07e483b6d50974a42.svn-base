#!/bin/bash

. ../set_mig_env.sh $*

if [ -e "$FILE_PATH.ht" ]; then
	. ../hash_total.sh check "$FILE_PATH" "$FILE_PATH.ht" 270,19 308,4
fi

if [ ! "$IS_PROCEED" = "true" ]; then
	return
fi

"$DB2_HOME"/bin/db2 LOAD FROM "$FILE_PATH" OF ASC MODIFIED BY TIMESTAMPFORMAT=\"DDMMYYYY\" DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL STRIPTBLANKS NULLINDCHAR=Y METHOD L \( 1 1, 2 21, 22 26, 27 66, 67 106, 107 166, 167 169, 170 171, 172 191, 192 192, 193 193, 194 201, 202 209, 210 249, 250 269, 270 288, 289 291, 292 299, 300 307, 308 311, 312 371, 372 390, 391 415, 416 434, 435 454, 455 455, 456 470, 471 495, 496 503, 504 507, 508 532, 533 552, 553 567, 568 582, 583 601, 602 620, 621 621, 622 629, 630 729, 730 730, 731 732, 733 733, 734 768, 769 787, 788 788, 789 789, 790 797, 798 817, 818 818, 819 833, 834 841, 842 856\) MESSAGES "$LOG_PATH" TEMPFILES PATH "$TEMPFILE_PATH" REPLACE INTO "$DB_SCHEMA".MIG_CO001_AB \(RECORD_TYPE, SECURITY_ID, CMS_SECURITY_SUBTYPE_ID, SECURITY_REF_NOTE, SOURCE_SECURITY_TYPE, SOURCE_SECURITY_SUB_TYPE, CURRENCY, LOC_COUNTRY, LOC_ORG_CODE, CUSTODIAN_TYPE, LEGAL_ENFORCEABILITY, LEGAL_ENFORCEABILITY_DATE, SECURITY_PERFECTION_DATE, ASSET_DESC, ASSET_TYPE_CODE, PURCHASE_PRICE, PURCHASE_PRICE_CURRENCY, PURCHASE_DATE, REG_DATE, MANUFACTURE_YEAR, MODEL_NO, SALES_PROCEED, REG_NO, REG_FEE, BRAND, GOOD_STAT, REG_CARD_NUMBER, CHASSIS_NUMBER, REPOSESSION_DATE, REPOSESSION_AGE, ENGINE_NUMBER, HORSE_POWER, DOWN_PAYMENT_TRADE_IN, DOWN_PAYMENT_CASH, FREIGHT_CHARGES, PRICE_LIST, PUBLIC_TRANSPORT, SECURITY_MATURITY_DATE, SECURITY_CUSTODIAN, PHY_INSPECTION_DONE, ENV_RISKY_STATUS, BORROWER_DEPENDENCY, SERIAL_NO, SCRAP_VALUE, EXCHANGE_CONTROL_OBTAINED, IS_CGC_PLEDGED, CHATTEL_SOLD_DATE, RL_SERIAL_NO, COLLATERAL_STATUS, VEHICLE_COLOR, ROAD_TAX_EXPIRY_DATE, E_HAK_MILIK_NUMBER\) NONRECOVERABLE INDEXING MODE AUTOSELECT