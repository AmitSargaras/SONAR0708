. set_mig_env.sh $*

if [ ! "$IS_PROCEED" = "true" ]; then
	return
fi


"$DB2_HOME"/bin/db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P \(1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62\)  MESSAGES "$LOG_PATH" REPLACE INTO "$DB_SCHEMA".MIG_PT \(CIF_NUMBER,FAC_DESC,SOURCE_SECURITY_ID,SECURITY_TYPE,SECURITY_SUB_TYPE,SECURITY_CURRENCY,SECURITY_LOCATION,SECURITY_ORGANISATION,SECURITY_CUSTODIAN_TYPE,SECURITY_CUSTODIAN_VALUE,SECURITY_MATURITY_DATE,SECURITY_PERFECTION_DATE,LEGAL_ENFORCEABILITY_IND,LEGAL_ENFORCEABILITY_DATE,SECURITY_REF_NOTE,EXCHANGE_CONTROL_OBTAINED,PHYSICAL_INSPECTION_IND,LAST_PHYSICAL_INSPECTION_DATE,NEXT_PHYSICAL_INSPECTION_DATE,PHYSICAL_INSPECTION_FREQ_UNIT,PHYSICAL_INSPECTION_FREQ_UOM,SEC_ENVIRONMENTAL_RISKY_IND,DATE_SEC_CONFIRM_ENV_RISKY,REMARKS_SEC_ENV_RISKY,ASSET_DESC,SALES_PURCHASE_AGREEMENT_VALUE,TITLE_TYPE,TITLE_NUMBER,LOT_NO,LOT_LOCATION,POSCODE,LAND_AREA,LAND_AREA_UOM,BUILT_UP_AREA,BUILT_UP_AREA_UOM,TENURE_VALUE,TENURE,RESTRICTION_CONDITION,EXPRESSED_CONDITION,QUIT_RENT_AMT_PAID,REMARKS,REGISTERED_OWNER,PROPERTY_ADDRESS,STATE,DISTRICT,MUKIM,REAL_ESTATE_FEW_RENTAL_UNITS,PROPERTY_USAGE_TYPE,DEVELOPER_NAME,ABANDONED_PROJECT_IND,PROPERTY_COMPLETION_STATUS,CATEGOTY_OF_LAND_USE,PROPERTY_TYPE,PHASE_NUMBER,PROJECT_NAME,UNIT_PARCEL_NO,INDEPENDENT_VALUER_IND,QUIT_RENT_IND,QUIT_RENT_RECEIPT_IND,QUIT_RENT_AMT_PAID_2,PROJECT_NUMBER\) FOR EXCEPTION "$DB_SCHEMA".MIG_PT_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

"$DB2_HOME"/bin/db2 SET INTEGRITY FOR "$DB_SCHEMA".MIG_PT IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "$DB_SCHEMA".MIG_PT USE "$DB_SCHEMA".MIG_PT_ERR


"$DB2_HOME"/bin/db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P \(4,2,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79\)  MESSAGES "$LOG_PATH" REPLACE INTO "$DB_SCHEMA".MIG_CHARGE_PT \(SOURCE_SECURITY_ID, SOURCE_LIMIT_ID, SECURITY_RANKING, CHARGE_TYPE, NATURE_OF_CHARGE, CHARGE_CURRENCY, CHARGE_AMT, DATE_LEGALLY_CHARGE, PRIOR_CHARGEE, PRIOR_CHARGE_TYPE, PRIOR_CHARGE_CCY, PRIOR_CHARGE_AMT, CAVEAT_WAIVED_IND, CAVEAT_REF_NUMBER, EXPIRY_DATE, PRESENTATION_NUMBER, PRESENTATION_DATE, DATE_LODGED, SOLICITOR_NAME\) FOR EXCEPTION "$DB_SCHEMA".MIG_CHARGE_PT_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

"$DB2_HOME"/bin/db2 SET INTEGRITY FOR "$DB_SCHEMA".MIG_CHARGE_PT IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "$DB_SCHEMA".MIG_CHARGE_PT USE "$DB_SCHEMA".MIG_CHARGE_PT_ERR


"$DB2_HOME"/bin/db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P \(1,4,2,80,81,82,83,84\)  MESSAGES "$LOG_PATH" REPLACE INTO "$DB_SCHEMA".MIG_PLEDGOR_PT \(CIF_NUMBER, SOURCE_LIMIT_ID, SOURCE_SECURITY_ID, IS_BORROWER_PLEDGOR, CIF_PLEDGOR1, CIF_PLEDGOR2, CIF_PLEDGOR3, CIF_PLEDGOR4\) FOR EXCEPTION "$DB_SCHEMA".MIG_PLEDGOR_PT_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE
	
"$DB2_HOME"/bin/db2 SET INTEGRITY FOR "$DB_SCHEMA".MIG_PLEDGOR_PT IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "$DB_SCHEMA".MIG_PLEDGOR_PT USE "$DB_SCHEMA".MIG_PLEDGOR_PT_ERR


"$DB2_HOME"/bin/db2 LOAD FROM "%FILE_PATH%" OF DEL MODIFIED BY COLDEL, DUMPFILE="$DUMP_PATH" IMPLIEDDECIMAL TIMESTAMPFORMAT=\"YYYYMMDD\" METHOD P \(4,85,86,87,88,89,90,91,92\)  MESSAGES "$LOG_PATH" REPLACE INTO "$DB_SCHEMA".MIG_VAL_PT \(SOURCE_SECURITY_ID, VALUATION_DATE, VALUATION_CCY, VALUATION_OMV, VALUER, VALUATION_FSV, COMMENTS, RESERVE_PRICE, RESERVE_PRICE_DATE\) FOR EXCEPTION "$DB_SCHEMA".MIG_VAL_PT_ERR NONRECOVERABLE CHECK PENDING CASCADE IMMEDIATE

"$DB2_HOME"/bin/db2 SET INTEGRITY FOR "$DB_SCHEMA".MIG_VAL_PT IMMEDIATE CHECKED FORCE GENERATED FULL ACCESS FOR EXCEPTION IN "$DB_SCHEMA".MIG_VAL_PT USE "$DB_SCHEMA".MIG_VAL_PT_ERR
