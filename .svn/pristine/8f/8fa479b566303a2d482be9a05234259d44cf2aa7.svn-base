CREATE OR REPLACE PROCEDURE SP_PARTY_SCREEN_MIG_VALIDATE
AS
  V_LISTED_COMPANY VARCHAR2(10);
  V_ISIN_NO VARCHAR(50);
  CURSOR CR_DATA
  IS
    SELECT * FROM TEMP_CHANGES_PARTY WHERE UPDATE_STATUS = 'N';
  RC_DATA CR_DATA%ROWTYPE;
BEGIN
  OPEN CR_DATA;
  LOOP
    FETCH CR_DATA INTO RC_DATA;
    EXIT
  WHEN CR_DATA%NOTFOUND;
    V_LISTED_COMPANY   := RC_DATA.LISTED_COMPANY;
	V_ISIN_NO := RC_DATA.LISTED_COMPANY;
    IF V_LISTED_COMPANY = 'Yes' OR V_LISTED_COMPANY='No' THEN
      UPDATE TEMP_CHANGES_PARTY
      SET IS_VALIDATED = 'Y'
      WHERE LSP_LE_ID  = RC_DATA.LSP_LE_ID;
	
	IF V_LISTED_COMPANY = 'Yes' AND V_ISIN_NO IS NULL THEN
		UPDATE TEMP_CHANGES_PARTY
      SET IS_VALIDATED = 'N'
      WHERE LSP_LE_ID  = RC_DATA.LSP_LE_ID;
	END IF;
    END IF;
  END LOOP;
  CLOSE CR_DATA;
  COMMIT;
END SP_PARTY_SCREEN_MIG_VALIDATE;
