<?xml version="1.0" encoding="UTF-8"?>
<reports>
	<report>
		<query>
			(		SELECT sub_profile.lsp_short_name    AS party_name,
					 cc_segment.entry_name              AS segmentName,
					 cr.region_name as region,
					 csupdate.id AS caseid,
				
				sysbranch.system_bank_branch_name as branchName,
				
				case 
				 when checklist.category='O' then 'Other'
				when checklist.category='F' then 'Facility'
				when checklist.category='S' then 'Security'
				when checklist.category='CAM' then 'CAM'
				end 
				as DocumentType,
				
				case 
				 when checklist.category='O' then ' '
				when checklist.category='F' then apprlimit.facility_name
				when checklist.category='S' then ' '
				when checklist.category='CAM' then ' '
				end as FacilityName,
				
				case 
				 when checklist.category='O' then ' '
				when checklist.category='F' then ' '
				when checklist.category='S' then sec.type_name ||'-'||sec.subtype_name
				when checklist.category='CAM' then ' '
				end as securitytype,
				 
				  checklistitem.doc_description      AS DocumentName,
				  checklistitem.document_code        AS DocumentCode,
				  	case 
				 when casecreation.status='1' then 'CPUT Requested'
				when casecreation.status='2' then 'BRANCH Sent'
				when casecreation.status='3' then 'CPUT Received'
				when casecreation.status='4' then 'Wrong Request'
        when casecreation.status='5' then 'Wrong Request Accepted'
        WHEN casecreation.status='6'
      THEN 'Sent to vault'
      WHEN casecreation.status='7'
      THEN 'Received at Vault'
      WHEN casecreation.status='8'
      THEN 'Permanent Retrieval'
      WHEN casecreation.status='9'
      THEN 'Temporary Retrieval'
				end 
				  AS Status,
				  casecreation.remark                AS Remarks,
				  to_char(casecreation.requested_date,'DD/Mon/YYYY')  as RequestedDate,
    			  to_char(casecreation.dispatched_date,'DD/Mon/YYYY') as DispatchedDate,
    			  to_char(casecreation.received_date,'DD/Mon/YYYY') as ReceivedDate
				  
				FROM SCI_LE_SUB_PROFILE sub_profile ,
				  SCI_LE_MAIN_PROFILE main_profile ,
				  (SELECT entry_name,
				    entry_code
				  FROM common_code_category_entry
				  WHERE category_code = 'HDFC_SEGMENT'
				  ) cc_segment ,
				  
				  sci_lsp_lmt_profile lmt_profile ,
				  cms_casecreation_item casecreation ,
          cms_casecreationupdate  csupdate,
          SCI_LE_REG_ADDR addr   ,
          CMS_REGION cr,
          cms_system_bank_branch sysbranch,
				  cms_checklist_item checklistItem,
          cms_checklist checklist,
          SCI_LSP_APPR_LMTS apprlimit,
          CMS_SECURITY sec
		
		
				

			</query>
		<whereClause>
			<mandatoryClause>
				sub_profile.cms_le_main_profile_id = main_profile.cms_le_main_profile_id
				AND cc_segment.entry_code                =main_profile.lmp_sgmnt_code_value
				AND sub_profile.lsp_le_id                =lmt_profile.llp_le_id
				AND sub_profile.status                          ='ACTIVE'
				AND csupdate.limit_profile_id          = lmt_profile.CMS_LSP_LMT_PROFILE_ID
        AND csupdate.id = casecreation.casecreationid
				AND casecreation.checklistitemid         =checklistitem.doc_item_id
        and addr.cms_le_main_profile_id=sub_profile.cms_le_main_profile_id   
        and  addr.lra_type_value ='CORPORATE'  
        and cr.id=addr.lra_region 
        and sysbranch.system_bank_branch_code = csupdate.branchcode
        and checklistitem.checklist_id= checklist.checklist_id
        and checklistItem.is_deleted='N'
        and checklistItem.status not in ('WAIVED')
        and checklist.cms_collateral_id=apprlimit.CMS_LSP_APPR_LMTS_ID(+)
        and checklist.cms_collateral_id= sec.cms_collateral_id(+)
        AND checklist.category != 'S' 
        AND apprlimit.CMS_LIMIT_PROFILE_ID =lmt_profile.CMS_LSP_LMT_PROFILE_ID 
        AND apprlimit.CMS_LIMIT_STATUS = 'ACTIVE'
			</mandatoryClause>
			<param>
				<name>party</name>
				<condition> AND sub_profile.CMS_LE_SUB_PROFILE_ID = </condition>
			</param>
			<param>
				<name>status</name>
				<condition> and casecreation.status  = </condition>
				
			</param>
		</whereClause>
		<reportParamters>
			<reportColumns>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Party Name</header>
				</reportColumn>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Segment Name</header>
				</reportColumn>
				<reportColumn>
					<width>100</width>
					<format>textFormat</format>
					<header>Party Region</header>
				</reportColumn>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Case Id</header>
				</reportColumn>
				<reportColumn>
					<width>200</width>
					<format>textFormat</format>
					<header>Case Creation Branch</header>
				</reportColumn>
				<reportColumn>
					<width>200</width>
					<format>textFormat</format>
					<header>Document Type</header>
				</reportColumn>
				<reportColumn>
					<width>200</width>
					<format>textFormat</format>
					<header>Facility Name</header>
				</reportColumn>
				<reportColumn>
					<width>200</width>
					<format>textFormat</format>
					<header>Security Type Sub Type</header>
				</reportColumn>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Document Name</header>
				</reportColumn>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Document Code</header>
				</reportColumn>
				<reportColumn>
					<width>50</width>
					<format>textFormat</format>
					<header>Case Status</header>
				</reportColumn>
				<reportColumn>
					<width>200</width>
					<format>textFormat</format>
					<header>Remarks</header>
				</reportColumn>
				<reportColumn>
					<width>25</width>
					<format>textFormat</format>
					<header>Request date</header>
				</reportColumn>
				<reportColumn>
					<width>25</width>
					<format>textFormat</format>
					<header>Dispatched On</header>
				</reportColumn>
				<reportColumn>
					<width>25</width>
					<format>textFormat</format>
					<header>Received On</header>
				</reportColumn>
			</reportColumns>
			<reportName>Case Creation Report</reportName>
		</reportParamters>
	</report>
</reports>